\documentclass[
  ngerman,english, % change to ngerman for german theses
  fontsize=12pt,twoside,BCOR=6mm, % use two-side for booklike layouts
  numbers=noenddot, % remove trailing dots in chapter/section/... enumeration
  cd=fullcolor,
  open=right,
  headings=heavy,
  chapterpage=true,
  cdfont=off, % modify this to use the TUD font (Open Sans)
  sfdefaults=false,
]{tudscrmanual}

% use a custom serif font
\usepackage[bitstream-charter]{mathdesign}

\newcommand{\mathdefault}[1][]{}

\usepackage[hyphens]{url}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[
  english % change to ngerman for german theses
]{babel}
\usepackage{isodate}
\usepackage{pdfpages}
\usepackage{listings}
\usepackage[toc, page]{appendix}
\usepackage{hyphenat}

\usepackage[
  citestyle=numeric-comp,
  bibstyle=ieee,
  backend=biber,
  url=false,
  doi=true,
  isbn=true,
  backref=true,
  hyperref,
  maxbibnames=99,
  maxcitenames=99,
]{biblatex}
% configure the location of the biblatex file
\addbibresource{students.bib}
\addbibresource{papers.bib}
\addbibresource{bibliography.bib}
\AtEveryBibitem{%
  \clearfield{note}%
}
\BiblatexSplitbibDefernumbersWarningOff

\makeatletter
\newcommand{\customlabel}[2]{%
   \protected@write \@auxout {}{\string \newlabel {#1}{{#2}{\thepage}{#2}{#1}{}} }%
   \hypertarget{#1}{#2}
}
\makeatother

\usepackage{graphicx}
\graphicspath{ {./} }
\usepackage{svg}

\usepackage{caption}
\captionsetup{font={footnotesize},labelsep=colon,justification=justified,format=plain}
\captionsetup[table]{position=bottom}
\usepackage{floatrow}
\floatsetup{font=normalfont}
\floatsetup[table]{capposition=bottom}
\DeclareCaptionSubType[alph]{figure}
\DeclareCaptionSubType[alph]{table}

\usepackage{booktabs}
\usepackage{longtable}

\usepackage{enumitem}
\setlist[itemize]{noitemsep}
\setlist{parsep=0pt,listparindent=\parindent}

\usepackage{float}
\usepackage{pgf}

% use \tocless before a chapter/section/... in the
% appendix to hide it from the toc
\newcommand{\nocontentsline}[3]{}
\newcommand{\tocless}[2]{
  \bgroup\let\addcontentsline=\nocontentsline#1{#2}\egroup
}

\usepackage{amsmath}

% https://github.com/priobike/priobike-flutter-app/blob/dev/lib/common/layout/ci.dart
\definecolor{ciblue}{HTML}{0069b4}
\definecolor{cidarkblue}{HTML}{00305D}
\usepackage[colorlinks=true,allcolors=ciblue]{hyperref}%
\usepackage[capitalise,nameinlink,noabbrev]{cleveref} % Must be loaded after amsmath
\hypersetup{
  colorlinks=true,
  linkcolor=cidarkblue,
  filecolor=cidarkblue,
  citecolor=cidarkblue,      
  urlcolor=cidarkblue,
}

\usepackage{mdframed}
\newcounter{Summary}[section]
\newenvironment{Summary}[1][]{%
    \stepcounter{Summary}%
    \vspace{6mm}
    \begin{mdframed}[
        linewidth=2,
        linecolor=cidarkblue,
        innertopmargin=0pt, 
        innerbottommargin=0em, 
        innerleftmargin=0em,
        innerrightmargin=16pt,
        topline=false, 
        leftline=false, 
        bottomline=false
    ]
    \vspace{-6mm}
    \subsubsection*{#1}
}{%
    \end{mdframed}
}

\renewcommand{\floatpagefraction}{1}
\renewcommand{\textfraction}{0}
\usepackage[all]{nowidow}% Avoid orphaned lines on new pages

\setlength{\parindent}{0cm}
\setlength{\parskip}{0.3cm plus 1mm minus 1mm}
\setlength{\intextsep}{0.6cm}

\usepackage{multirow}
\usepackage[sort=none,abbreviations]{glossaries-extra}
\loadglsentries[main]{sections/glossary}
% \usepackage{glossary-mcols}
% \renewcommand{\glsmcols}{2}
\newglossarystyle{dotglos}{%
    \setglossarystyle{list}%
    \renewcommand*{\glossentry}[2]{%
        \item[\glsentryitem{##1}\glstarget{##1}{\glossentryname{##1}}]
        \ifglshassymbol{##1}{[\glossentrysymbol{##1}]\quad}{}%
        \dotfill\quad%
        \glossentrydesc{##1}%
        ##2%
        \vspace{2mm}}%
    \renewcommand*{\glsgroupskip}{}%
}
\setglossarystyle{dotglos}

\begin{document}
\addtokomafont{disposition}{\rmfamily}
\addtokomafont{title}{\rmfamily}
\addtokomafont{titlepage}{\rmfamily}
\addtokomafont{thesis}{\rmfamily}
\addtokomafont{tudheadings}{\rmfamily}
\addtokomafont{partsubtitle}{\rmfamily}
\addtokomafont{chaptersubtitle}{\rmfamily}
\addtokomafont{author}{\rmfamily}
\addtokomafont{caption}{\rmfamily}
\addtokomafont{captionlabel}{\rmfamily}
\addtokomafont{chapter}{\rmfamily}
\addtokomafont{chapterentry}{\rmfamily}
\addtokomafont{chapterentrydots}{\rmfamily}
\addtokomafont{chapterentrypagenumber}{\rmfamily}
\addtokomafont{chapterprefix}{\rmfamily}
\addtokomafont{date}{\rmfamily}
\addtokomafont{dedication}{\rmfamily}
\addtokomafont{descriptionlabel}{\rmfamily}
\addtokomafont{dictum}{\rmfamily}
\addtokomafont{dictumtext}{\rmfamily}
\addtokomafont{footnote}{\rmfamily}
\addtokomafont{footnotelabel}{\rmfamily}
\addtokomafont{footnotereference}{\rmfamily}
\addtokomafont{footnoterule}{\rmfamily}
\addtokomafont{labelinglabel}{\rmfamily}
\addtokomafont{labelingseparator}{\rmfamily}
\addtokomafont{minisec}{\rmfamily}
\addtokomafont{pagefoot}{\rmfamily}
\addtokomafont{pagehead}{\rmfamily}
\addtokomafont{pageheadfoot}{\rmfamily}
\addtokomafont{pagenumber}{\rmfamily}
\addtokomafont{pagination}{\rmfamily}
\addtokomafont{paragraph}{\rmfamily}
\addtokomafont{part}{\rmfamily}
\addtokomafont{partentry}{\rmfamily}
\addtokomafont{partentrypagenumber}{\rmfamily}
\addtokomafont{partnumber}{\rmfamily}
\addtokomafont{publishers}{\rmfamily}
\addtokomafont{section}{\rmfamily}
\addtokomafont{sectioning}{\rmfamily}
\addtokomafont{subject}{\rmfamily}
\addtokomafont{subparagraph}{\rmfamily}
\addtokomafont{subsection}{\rmfamily}
\addtokomafont{subsubsection}{\rmfamily}
\addtokomafont{subtitle}{\rmfamily}
\addtokomafont{title}{\rmfamily}
\addtokomafont{titlehead}{\rmfamily}

\faculty{\scriptsize\textbf{Faculty of Computer Science}}
\institute{\scriptsize Institute of Systems Architecture}
\chair{\scriptsize Chair of Distributed and Networked Systems}
\definecolor{titlewhite}{HTML}{ffffff}
\title{Green Light Optimal\\Speed Advisory for Bikes}

\thesis{phd} % the type of thesis you want to write
\graduation[\Large Dr.-Ing.]{\Large Doctor of Engineering}

\author{Dipl.-Inf. Philipp Matthes}

% \referee{Prof. Dr.-Ing. Christoph Sommer \and Prof. Dr.-Ing. habil. Monika Sester}
\referee{Prof. Dr.-Ing. Christoph Sommer}
\advisor{Dr.-Ing. Thomas Springer}
\date{} % the date of submission

\maketitle[cdgeometry=symmetric]

\sloppy

\TUDoption{abstract}{section,multiple,markboth}
\renewcommand\abstractname{Abstract}
\begin{abstract}\small
Promoting cycling is a crucial solution to improve the livability of urban environments. A non-invasive way to promote cycling is to enhance the bike ride experience via Green Light Optimal Speed Advisory (bike-GLOSA). This work presents such a system for Hamburg, making bike-GLOSA practical in real-world urban environments and evaluating its impact on bike rides. 

GLOSA systems ingest data from traffic lights to predict their switching behavior and provide speed advisories to users. In the first challenge, we need to find whether the data is reliable, overseeing thousands of traffic lights throughout the city area. We develop a quality assurance framework and monitor the prediction quality over a longer period. Affected by data outages, we achieve a median prediction availability of 55\% (max: 91\%) and prediction quality of 86\%. We identify concrete weak points, enhancing prediction availability. Furthermore, based on four weeks of data for 18,009 traffic lights, we find that traffic adaptivity may be less problematic for traffic light prediction than previously envisioned.

Afterward, we develop a novel method to match traffic lights along the user's trajectory. Instead of using the user's location or camera, our method matches traffic lights along a precalculated bike route geometry. However, errors and inaccuracies in bike routes challenge this approach, requiring an advanced model that employs spatial reasoning to find which associated traffic light turn geometries match the given route geometry. The final model achieves matching F1 scores of 92\% and 86\% validated on a separate dataset, requiring a median extra time of 1.4 seconds during bike route calculation. 

Building on these results, we focus on reducing bike routing errors and enhancing route alignment with actual bike paths. Our solution involves an authoritative bike routing dataset and cross-border routing to OpenStreetMap. Apart from a more consistent surface coverage, we find better alignment with actual cycling infrastructure, traffic lights, and user trajectories than with other routing providers. Enhanced alignment and 37\% fewer routing errors lead to a 4.74\% increase in traffic light matching F1 score. A route-based distance-to-signal estimation is proposed, showing a more stable distance estimation than the over-the-air distance from related work. 

We combine the developed components in a smartphone app and conduct an unsupervised long-term test throughout 2023 with Hamburg citizens. Survey responses suggest a twofold effect of the speed advisory: rolling out in anticipation of red and accelerating to catch green. These effects are also visible in the recorded data. Approaches with adherence to the speed advisory have 15.32\% fewer stops but a 3.3\% increase in energy expenditure to catch the green phase by cycling 2.92 km/h faster. Approaches without adherence have a 12.85\% higher chance of stopping and a 3.39 km/h decrease in speed while saving 5.5\% in energy and rolling out earlier. Combined, these cases cancel out each other, with a 0.74 km/h slower traffic light passing speed, 1.4\% estimated energy savings, 0.73\% increased stop rate, and 1.46 seconds increased waiting time when stopped.

Based on the survey, users report a System Usability Scale of 73, with improvable reliability and coverage of speed advisories. Among many ways to improve our developed solution, users see enhanced informedness, reduced stops, and increased comfort as key benefits. We thoroughly analyze these findings and outline potential directions for future research.
\end{abstract}

\newpage

% \addcontentsline{toc}{chapter}{Acknowledgments}
% \markboth{Acknowledgments}{Acknowledgments}

% \section*{Acknowledgments}

% Special thanks are extended to Dr. Thomas Springer for his invaluable guidance throughout the PrioBike project and for providing me with the opportunity to contribute to it. I am grateful to Dr. Philipp Grubitzsch and Stephan Dinter for their assistance in familiarizing me with the project. Prof. Christoph Sommer deserves special recognition for his constructive feedback and willingness to supervise me as a doctoral student. 

% I would like to express my gratitude to Dr. Lucas Vogel for his continuous support with formal matters related to my doctorate. Special thanks are also due to Daniel Jeschor and Paul Pickhardt for their support in software development throughout my doctoral journey. Prof. Matthias Wählisch's rigorous guidance has been instrumental in refining my scientific thinking and communication skills, and I am thankful for the opportunities he provided for me to attend workshops and international conferences. I am indebted to everyone I met at conferences and workshops for the enriching insights they provided. 

% Thanks to the many motivated students and student developers I had the opportunity to guide and learn from. The support from Hamburg's authorities and the PrioBike consortium, particularly Dr. Ute Ehlers and Kerstin Spahn, is deeply appreciated. I would also like to acknowledge to Prof. Monika Sester for her openness to being my second referee and Prof. Claus Brenner for pointing out similarities to related work. Thanks to Felix Kästner as well for helping me refine my final manuscript. Lastly, I extend my special thanks to Victoria Scheer for her feedback on my text style and overall support.

\subsubsection*{Datasets and Figures}

Map tiles for figures in this work use map data from CARTO, CyclOSM, Mapbox, and OpenStreetMap and their data sources. To learn more, visit \url{https://carto.com/basemaps}, \url{https://www.cyclosm.org/}, \url{https://www.mapbox.com/about/maps/}, and \url{https://www.openstreetmap.org/copyright}.

Screenshots of the developed mobile application use Google Material Icons. These icons are available under \url{https://fonts.google.com/icons} and were licensed under Apache License, Version 2.0: \url{https://www.apache.org/licenses/LICENSE-2.0.txt}.

Traffic light and detector data was provided by the Free and Hanseatic City of Hamburg, Landesbetrieb für Straßen, Brücken und Gewässer (LSBG), Data License Germany Version 2.0: \url{https://www.govdata.de/dl-de/by-2-0}. Dataset URL: \url{https://metaver.de/trefferanzeige?docuuid=AB32CF78-389A-4579-9C5E-867EF31CA225}.

Digitales Radverkehrsnetz Hamburg (DRN) data was provided by the Free and Hanseatic City of Hamburg, Behörde für Verkehr und Mobilitätswende (BVM), Data License Germany Version 2.0: \url{https://www.govdata.de/dl-de/by-2-0}. Dataset URL: \url{https://metaver.de/trefferanzeige?docuuid=EA847D9F-6403-4B75-BCDB-73F831F960C7}

Lichtsignalanlagen Hamburg data was provided by the Free and Hanseatic City of Hamburg, Landesbetrieb für Straßen, Brücken und Gewässer (LSBG), Data License Germany Version 2.0: \url{https://www.govdata.de/dl-de/by-2-0}. Dataset URL: \url{https://metaver.de/trefferanzeige?docuuid=C498DEED-985C-11D5-889E-000102B6A10E}

\subsubsection*{Funding}

This work is funded by the Federal Ministry for Digital and Transport (Bundesministerium für Digitales und Verkehr, FKZ: 16DKVM001B).
\vfill

\newpage

\tableofcontents

% this is where your thesis lives

% \nocite{jeschor2024cloudy}
\nocite{matthes2022matching}
\nocite{matthes2023geo}
\nocite{matthes2023accurate}
\nocite{matthes2022selecting}

\nocite{lorenz_2022}
\nocite{pickhardt_2022}
\nocite{jeschor_2022}
\nocite{lahr_2023}
\nocite{pickhardt_2023}
\nocite{wieland_2023}
\nocite{pix_2024}

\input{sections/introduction.tex}
\input{sections/prediction.tex}
\input{sections/matching.tex}
\input{sections/routing.tex}
\input{sections/app.tex}
\input{sections/conclusions.tex}

\newpage

\emergencystretch=10em

\chapter*{\bibname}
\addcontentsline{toc}{chapter}{\bibname}
\markboth{Bibliography}{Bibliography}

\section*{Published Research Papers}
This thesis is based on the following peer-reviewed research papers in which the author was the principal investigator:
\printbibliography[heading=none,nottype=student,keyword={ownpaper,related}]
The following study, although not directly pivotal for this work, inspired hyperparameter tuning of the machine learning model in \Cref{ch:matching}, as well as GNSS-related aspects of smartphone sensor handling in \Cref{ch:routing} and \Cref{ch:app}:
\printbibliography[heading=none,notkeyword={student},keyword={ownpaper,notrelated}]
\vfill
\pagebreak

\section*{Supervised Student Theses}
The author of this thesis identified several topics for student theses and was involved as supervisor:
\printbibliography[heading=none,keyword={student},notkeyword={ownpaper}]
\vfill
\pagebreak

\section*{References}
\printbibliography[heading=none,notkeyword={student},notkeyword={ownpaper,notrelated},notkeyword={ownpaper,related}]
\vfill
\pagebreak

\newpage
\renewcommand{\glsnamefont}[1]{\color{cidarkblue} \textbf{#1} \dotfill}
\printunsrtglossary[type=abbreviations,title={Abbreviations}]

\end{document}